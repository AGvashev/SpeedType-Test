<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }
        .mainText {
            width: 680px;
            height: 225px;
            overflow: hidden;
            float: left;
            margin-right: 45px;
            font-size: 21px;
            line-height: 32px;

            background-color: pink;
            padding: 10px;
            border-radius: 5px;
        }

        .blackW {
            color: #000;
        }

        .passedW {
            color: #5bc538;
        }

        .greenW {
            background-color: #5bc538;
            padding: 3px;
            border-radius: 3px;
            color: #fff;
        }

        .redW {
            background-color: #fc0000;
            padding: 3px;
            border-radius: 3px;
            color: #fff;
        }
        

    </style>
</head>
<body>
    
    <div id="app">
        
        <div class="mainText">
            <span 
            v-for="(item, index) in message"
            v-bind:class="[index == greenNow ? 'greenW' : '', greenNow > index ? 'passedW' : '', index > greenNow ? 'blackW' : '']"
            >{{item}}</span>
        </div>
            
        <div class="stat">
            <span v-for="(stat, name) in stats">
                {{ name }}: {{ name == 'Accuracy' ? stat += '%' : stat }}
            </span>

        </div>
            
    </div>

<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
<script>
    var app = new Vue({
        el: '#app',
        data: {
            message: 'Lorem, ipsum dolor sit amet consectetur adipisicing elit. Voluptatum, officia harum veritatis quo libero explicabo nesciunt voluptatibus, sapiente consequatur fuga tempore minima nemo laboriosam itaque nulla sequi, asperiores ex! Sequi!',
            greenNow: 0,
            misses: 0,
            stats: {
                WPM : 0,
                Timer : 0,
                Accuracy: 100
            }
        },
        methods: {
            test: () => {
            },
            start(){
                interval_timer = setInterval( () => {
                    this.stats.Timer ++;
                    this.stats.WPM = Math.round(this.greenNow / (this.stats.Timer / 60));
                }, 1000)
                
            },
            stop() {
                console.log('Стоп')
                clearInterval(interval_timer);
            },
            keyPressed (key) {
                let greenNowSymbol = document.querySelector('.greenW');
                let keyPressedNow = key.key;
                if (keyPressedNow == 'Shift' || keyPressedNow == 'Backspace') {
                    return
                } else if (greenNowSymbol.textContent == keyPressedNow) {
                    if (this.greenNow == 0) {
                        this.start();
                    }
                    greenNowSymbol.classList.add('wpased')
                    this.greenNow++
                    if (this.greenNow == (this.message.length) ) {
                        this.stop();
                        return console.log('конец')
                    }
                } else if (greenNowSymbol.textContent != keyPressedNow) {
                    if (!greenNowSymbol.classList.contains('redW')) {
                        this.misses++;
                        this.stats.Accuracy =  (this.stats.Accuracy - this.message.length/100).toFixed(1)
                        greenNowSymbol.classList.add('redW')
                    }
                }
            }
        },
        created: function () {
            window.addEventListener('keydown', this.keyPressed)
        },
        beforeDestroy: function () {
            window.removeEventListener('keydown', this.keyPressed)
        },
    })
</script>
</body>
</html>